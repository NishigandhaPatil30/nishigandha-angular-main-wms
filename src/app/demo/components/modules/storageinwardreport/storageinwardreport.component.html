<div class="grid">
	<div class="col-12">
		<div class="card">
<h1 style="text-align: center;">STORAGE INWARD REPORT</h1>
<div class="container">
  <div class="date-picker-container">
    <label for="fromDate">From Date:</label>
    <p-calendar id="fromDate" [(ngModel)]="selectedDate" dateFormat="dd-mm-yy" (onSelect)="fetchDataForReferenceDoNo()" placeholder="Please Select From Date"></p-calendar>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <label for="toDate">To Date:</label>
    <p-calendar id="toDate" [(ngModel)]="selectedDate1" dateFormat="dd-mm-yy" (onSelect)="fetchDataForReferenceDoNo()" placeholder="Please Select To Date"></p-calendar>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <label for="inputField">Vehicle Number:</label>
    <input pInputText id="inputField" [(ngModel)]="vehicleNumber" />
  </div>

  <br><br>
  <div class="ui-helper-clearfix" style="text-align: left" *ngIf="selectedDate && selectedDate1">
    <button type="button" pButton icon="pi pi-file-o" iconPos="left"  label="CSV" (click)="exportToExcel()" style="margin-right: 0.5em;"></button>
    <button type="button" pButton icon="pi pi-file-excel" iconPos="left" (click)="exportToExcel()" label="EXCEL"  style="margin-right: 0.5em;" class="ui-button-success"></button>

</div>
<br>
   <div *ngIf="selectedDate && selectedDate1">
    <p-table [value]="data" [loading]="isLoading" #dt1
             [rowHover]="true"
             [rows]="10"
             [showCurrentPageReport]="true"
             [rowsPerPageOptions]="[5, 10, 15, 30]"
             [paginator]="true"
             currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
             [filterDelay]="10"
             [globalFilterFields]="['Productcode', 'Brand', 'Pack','Batch','Manufacturingdates','Expirydate','Weight','Quantity','Cases','Invoicequantity','Storagelocation','UOM','Remark','vehiclenumber']"
    >
      <ng-template pTemplate="caption">
        <div class="flex">
          <button pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash" (click)="clear(dt1)"></button>
          <span class="p-input-icon-left ml-auto">
            <i class="pi pi-search"></i>
            <input pInputText type="text" #inputRef placeholder="Search keyword" (input)="dt1.filterGlobal(inputRef.value, 'contains')" />
          </span>
        </div>
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
              
               <th pSortableColumn="Productcode" style="width:20%">Productcode<p-sortIcon field="Productcode"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="Productcode" display="menu"></p-columnFilter>
                    </div>
                </th>
                 <th pSortableColumn="Brand" style="width:20%">Brand  <p-sortIcon field="Brand"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="Brand" display="menu"></p-columnFilter>
                    </div>
                </th>
<th pSortableColumn="Pack" style="width:20%">Pack  <p-sortIcon field="Pack"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="Pack" display="menu"></p-columnFilter>
                    </div>
                </th>
<th pSortableColumn="Batch" style="width:20%">Batch<p-sortIcon field="Batch"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="Batch" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th pSortableColumn="Manufacturingdates" style="width:20%">Manufacturingdates<p-sortIcon field="Manufacturingdates"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="Manufacturingdates" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th pSortableColumn="Expirydate" style="width:20%">Expirydate<p-sortIcon field="Expirydate"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="Expirydate" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th pSortableColumn="Weight" style="width:20%">Weight(Kg/Ltr)	<p-sortIcon field="Weight"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="Weight" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th pSortableColumn="Quantity" style="width:20%">Quantity(Box/Bags<p-sortIcon field="Quantity"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="Quantity" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th pSortableColumn="Cases" style="width:20%">Cases<p-sortIcon field="Cases"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="Cases" display="Cases"></p-columnFilter>
                    </div>
                </th>
                <th pSortableColumn="Invoicequantity" style="width:20%">Invoicequantity<p-sortIcon field="Invoicequantity"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="Invoicequantity" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th pSortableColumn="Storagelocation" style="width:20%">Storagelocation<p-sortIcon field="Storagelocation"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="Storagelocation" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th pSortableColumn="UOM" style="width:20%">UOM<p-sortIcon field="UOM"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="UOM" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th pSortableColumn="Remark" style="width:20%">Remark<p-sortIcon field="Remark"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="Remark" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th pSortableColumn="vehiclenumber" style="width:20%">vehiclenumber<p-sortIcon field="vehiclenumber"></p-sortIcon>
                    <div class="flex align-items-center">
                        
                        <p-columnFilter type="text" field="vehiclenumber" display="menu"></p-columnFilter>
                    </div>
                </th>
               <th>Print</th>
               <th>CSV -selection only</th>
        </ng-template>
        
     
      <ng-template pTemplate="body" let-item>
        <tr>
          <td>{{ item.Productcode }}</td>
          <td>{{ item.Brand }}</td>      
          <td>{{ item.Pack }}</td>  
          <td>{{ item.Batch }}</td>
          <td>{{ item.Manufacturingdates }}</td>
          <td>{{ item.Expirydate }}</td>
          <td>{{ item.Weight }}</td>
          <td>{{ item.Quantity }}</td>
          <td>{{ item.Cases }}</td>
          <td>{{ item.Invoicequantity }}</td>
          <td>{{ item.Storagelocation }}</td>
          <td>{{ item.UOM }}</td>
          <td>{{ item.Remark }}</td>
          <td>{{ item.vehiclenumber }}</td>
          <td><button pButton icon="pi pi-print" (click)="printData(item.Invoicequantity)"></button></td>
         
             
    <td><button type="button" pButton icon="pi pi-file" iconPos="left"   (click)="exportToCSV(item)" style="float:right"></button></td>
        </tr>
      </ng-template>
     
    </p-table>
   
  </div>
 
</div>
</div>
</div>
</div>